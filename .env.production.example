# Production Environment Configuration
# This file is used in Railway for the production environment
# All values are managed through Railway Secret Manager - DO NOT commit secrets!

# Application Environment
NODE_ENV=production
DEBUG=false
LOG_LEVEL=warn
PORT=3000

# Database Configuration
# Set via Railway environment variables (SECRET)
DATABASE_URL=${DATABASE_URL}
DATABASE_POOL_SIZE=20
DATABASE_POOL_IDLE_TIMEOUT=30000
DATABASE_CONNECTION_TIMEOUT=5000
DATABASE_SSL=true
DATABASE_SSL_MODE=require
DATABASE_REPLICA_URL=${DATABASE_REPLICA_URL}
DATABASE_STATEMENT_TIMEOUT=30000

# MongoDB Configuration
MONGODB_URI=${MONGODB_URI}
MONGODB_RETRY_WRITES=true
MONGODB_RETRY_WRITES_WAIT_MILLIS=5000
MONGODB_SSL=true

# Redis Configuration
REDIS_URL=${REDIS_URL}
REDIS_MAX_RETRIES=5
REDIS_TIMEOUT=5000
REDIS_CLUSTER_ENABLED=false
REDIS_SOCKET_KEEPALIVE=true

# Security Secrets (managed via Railway Secret Manager)
JWT_SECRET=${JWT_SECRET}
JWT_EXPIRATION=7d
JWT_REFRESH_SECRET=${JWT_REFRESH_SECRET}
JWT_REFRESH_EXPIRATION=30d
API_KEY_SECRET=${API_KEY_SECRET}
ENCRYPTION_KEY=${ENCRYPTION_KEY}
ENCRYPTION_KEY_BACKUP=${ENCRYPTION_KEY_BACKUP}

# Services Configuration
WORKER_CONCURRENCY=8
WORKER_QUEUE_NAME=production
WORKER_MAX_ATTEMPTS=3
WORKER_TIMEOUT=60000

# Feature Flags
ENABLE_BLUE_GREEN_DEPLOYMENT=true
ENABLE_EXPERIMENTAL_FEATURES=false
FEATURE_FLAG_SERVICE_URL=${FEATURE_FLAG_SERVICE_URL}

# Monitoring
SENTRY_DSN=${SENTRY_DSN}
SENTRY_ENVIRONMENT=production
SENTRY_TRACE_SAMPLE_RATE=0.01
SENTRY_PROFILES_SAMPLE_RATE=0.001
SENTRY_MAX_BREADCRUMBS=50

# Logging
LOG_FORMAT=json
LOG_COLORIZE=false
LOG_DESTINATION=stdout

# API Configuration
API_TIMEOUT=30000
API_RATE_LIMIT_ENABLED=true
API_RATE_LIMIT_WINDOW=900000
API_RATE_LIMIT_MAX=1000
API_RATE_LIMIT_KEY_PREFIX=prod

# CORS Configuration
CORS_ENABLED=true
CORS_ORIGINS=https://example.com,https://app.example.com
CORS_CREDENTIALS=true
CORS_MAX_AGE=86400

# Session Configuration
SESSION_SECRET=${SESSION_SECRET}
SESSION_TIMEOUT=3600000
SESSION_STORE=redis
SESSION_SECURE=true
SESSION_SAME_SITE=strict

# Cache Configuration
CACHE_TTL_DEFAULT=3600
CACHE_TTL_SESSION=1800
CACHE_TTL_CONFIG=86400
CACHE_REDIS_NAMESPACE=production
CACHE_MAX_SIZE=1000

# Email Configuration
EMAIL_PROVIDER=sendgrid
EMAIL_FROM=noreply@example.com
SENDGRID_API_KEY=${SENDGRID_API_KEY}
SENDGRID_SANDBOX_MODE=false

# External Services
GITHUB_TOKEN=${GITHUB_TOKEN}
GITHUB_WEBHOOK_SECRET=${GITHUB_WEBHOOK_SECRET}

# Third-party integrations
STRIPE_PUBLIC_KEY=${STRIPE_PUBLIC_KEY}
STRIPE_SECRET_KEY=${STRIPE_SECRET_KEY}
STRIPE_WEBHOOK_SECRET=${STRIPE_WEBHOOK_SECRET}

# Payment processing
PAYMENT_PROVIDER=stripe
PAYMENT_WEBHOOK_PATH=/webhooks/payment
PAYMENT_TIMEOUT=30000

# Analytics
ANALYTICS_ENABLED=true
ANALYTICS_SAMPLE_RATE=0.1
ANALYTICS_BATCH_SIZE=100
ANALYTICS_FLUSH_INTERVAL=30000

# Deployment
DEPLOYMENT_STRATEGY=blue-green
HEALTH_CHECK_INTERVAL=30
HEALTH_CHECK_TIMEOUT=5
HEALTH_CHECK_PATH=/health
HEALTH_CHECK_GRACE_PERIOD=40
READINESS_PROBE_PATH=/ready
LIVENESS_PROBE_PATH=/alive

# Versioning
APP_VERSION=${APP_VERSION}
BUILD_ID=${BUILD_ID}
BUILD_TIMESTAMP=${BUILD_TIMESTAMP}
GIT_COMMIT=${GIT_COMMIT}

# Performance Optimization
COMPRESSION_ENABLED=true
COMPRESSION_LEVEL=6
CACHE_CONTROL_MAX_AGE=31536000

# Security Headers
SECURITY_HEADERS_ENABLED=true
X_FRAME_OPTIONS=DENY
X_CONTENT_TYPE_OPTIONS=nosniff
STRICT_TRANSPORT_SECURITY=max-age=31536000; includeSubDomains

# Rate Limiting & Protection
RATE_LIMIT_ENABLED=true
RATE_LIMIT_STORE=redis
DOS_PROTECTION_ENABLED=true
IP_WHITELIST_ENABLED=false

# Database Backup
BACKUP_ENABLED=true
BACKUP_SCHEDULE=daily
BACKUP_RETENTION_DAYS=30
BACKUP_ENCRYPTION=true

# Disaster Recovery
DR_ENABLED=true
DR_REPLICATION_ENABLED=true
DR_RTO_MINUTES=60
DR_RPO_MINUTES=15

# Compliance
GDPR_MODE=true
DATA_RETENTION_DAYS=365
AUDIT_LOGGING_ENABLED=true

# Maintenance
MAINTENANCE_MODE=false
MAINTENANCE_MESSAGE=
GRACEFUL_SHUTDOWN_TIMEOUT=30000
